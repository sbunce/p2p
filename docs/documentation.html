<html>
<head>
<title>P2P Documentation</title>
</head>
<body>

<table>
<tr><td width="640">

<h2>About</h2>
<p>
This P2P program has it's own protocol. It uses multi-source segmented
downloading meaning that one file may be downloaded from multiple hosts at the
same time to increase speeds.
</p>

<hr>

<h2>Goals</h2>

<p>
<b>Bandwidth Efficiency:</b><br>
Ratio of control and error detection data to file data should be as low as
possible.
</p>

<p>
<b>Perfect Copies:</b><br>
The integrity of files should be checked via hash functions to insure
downloaded files are perfect copies.
</p>

<p>
<b>Unpoisonable:</b><br>
The presence of malicious peers should have minimal impact on file downloads.
</p>

<p>
<b>Obfuscation:</b><br>
The protocol should be obfuscated to make detecting the protocol difficult.
This should not take precedence over any other goal.
</p>

<p>
<b>Low Requirements:</b><br>
CPU and memory usage should be as low as possible.
</p>

<p>
<b>Location Awareness:</b><br>
Close servers should be favored over distant ones.
</p>

<hr>

<h2>Protocol</h2>
<p>
The protocol is symmetric with the exception of the key exchange. Any message
can go in either direction. Messages are fixed length. Each command has an
associated message length.
</p>

<fieldset>
<pre>
Name: ERROR
Base10: 0
Description: ERROR has different meanings in different contexts.

	+---+
	| C |
	+---+
	  0
</pre>
</fieldset>

<br>

<fieldset>
<pre>
Name: SLOT_ID
Base10: 3
Description: Sent in response to a REQUEST_SLOT_FILE or a
REQUEST_SLOT_HASH. The slot ID this contains is needed to request file blocks
or hash blocks.

	+---+---+
	| C | S | , S = slot ID
	+---+---+
	  0   1
</pre>
</fieldset>

<br>

<fieldset>
<pre>
Name: BLOCK
Base10: 5
Description: Either a hash block or a file block. The hash blocks are variable
size but the file blocks are 5121 bytes (including command).

	+---+---+---+---+---+---+---+---+
	| C |            block          |
	+---+---+---+---+---+---+---+---+
	  0   1   2   3   ......... 5121
</pre>
</fieldset>

<br>

<fieldset>
<pre>
Name: REQUEST_SLOT_HASH
Base10: 1
Description: Request a slot for downloading a hash tree. The slot ID is 1 byte
so 256 slots per connection are supported.

	+---+---+---+---+---+---+---+---+
	| C |         root hash         |
	+---+---+---+---+---+---+---+---+
	  0   1   2   3   ........    21

Possible Responses:
SLOT_ID
ERROR - The server does not have the requested hash tree.
</pre>
</fieldset>

<br>

<fieldset>
<pre>
Name: REQUEST_SLOT_FILE
Base10: 2
Description: Request a slot for downloading a file. The slot ID is 1 byte so 256
slots per connection are supported.

	+---+---+---+---+---+---+---+---+
	| C |         root hash         |
	+---+---+---+---+---+---+---+---+
	  0   1   2   3   ........    21

Possible Responses:
SLOT_ID
ERROR - The server does not have the requested file.
</pre>
</fieldset>

<br>

<fieldset>
<pre>
Name: CLOSE_SLOT
Base10: 4
Description: Close slot for hash tree or file.

	+---+---+
	| C | S | , S = slot ID
	+---+---+
	  0   1

No Response
</pre>
</fieldset>

<br>

<fieldset>
<pre>
Name: BLOCK
Base10: 5
Description: This is used to request a 5120 byte block from a file. The BLOCK
command is used to request a block from a hash tree or a file. A 5120 byte block
from a hash tree is 256 hashes.

	+---+---+---+---+---+---+---+---+
	| C | S |              RRN      | , S = slot ID
	+---+---+---+---+---+---+---+---+
	  0   1   2   3   .........  10

Possible Responses:
BLOCK
WAIT
ERROR - The server no longer has the file.
</pre>
</fieldset>

<br>

<hr>

<h3>Pipelining</h3>
<p>
The maximum pipeline size is 8 requests.
</p>
<p>
Pipelining is done by sending multiple requests when a download starts and a new
request whenever a response is received such that there are always requests
"in the pipeline". Pipelining makes it so the server is never sitting idle
waiting for a request.
</p>

<hr>

<h3>Rerequests</h3>
<p>
FINISH THIS
</p>

<hr>

<h3>Blacklist</h3>
<p>
FINISH THIS
</p>

<hr>

<h2>Building</h2>

<h3>GNU/Linux</h3>
<p>
There are many different flavors of GNU/Linux. Most likely you can use your package
manager to install these packages.
</p>
<p>
FINISH THIS
</p>

<h3>Windows</h3>

<p>
<a href="http://www.microsoft.com/express/vc/">Visual C++ Express 2008</a><br>
The command line compiler will be used by scons.
</p>

<p>
<a href="http://www.boostpro.com/products/free">Boost</a>Version &#62;= 1.36<br>
Precompiled libraries available from Boost Consulting. When installing select
multithreaded static.
</p>

<p>
<a href="http://ftp.gnome.org/pub/GNOME/binaries/win32/gtkmm/">gtkmm</a><br>
Install to "C:\gtkmm" or pkg-config won't work properly. Latest version
known to work is 2.12.7-3. The 2.14 versions are known to have problems building.
</p>

<p>
<a href="http://python.org/download/">Python</a><br>
This is used to run the build system (scons), which is included with the source
code.
</p>

<p>
After downloading and installing these dependencies open cmd.exe and navigate
to the source directory and run scons.
</p>

</tr></td>
</table>

</body>
</html>
